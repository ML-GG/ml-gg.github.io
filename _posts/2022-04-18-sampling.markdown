---
layout: post
title:  Sampling
date:   2022-04-18 21:28:10 +0200
description:    What does it mean to sample from a distribution?
categories: posts
---

# Premise

The operation of sampling is ubiquitous is statistics and machine learning. Many algorithms often require us to sample from normal distribution, or from a posterior distribution, or sometimes even sample from a function for which the formula is not fully known.  

In this short blog-post we will explain what sampling is about and give a few examples. However, we will assume one thing, namely that **we always can sample from uniform distribution between** $$0$$ **and** $$1$$. This is a fair assumption because of pseudorandom number generators such as mt19937 and many others that have been in use for decades for this exact purpose.  

We can now move to more interesting cases.


# Sampling from normal distribution - Box-Muller

First we will learn how to effectively sample from the normal distribution, arguably the most important of all distributions. You can do it in multiple ways, but here we will present a very efficient and clever procedure that is super easy to implement, it's called Box-Muller transform. The idea is simple, you take two samples from random uniform $$\mathcal{U} (0, 1)$$, you plug them into the Box-Muller transform and in return you get two samples from standard normal distribution $$\mathcal{N}(0, 1)$$.  

So how exactly do you get normal samples from the uniform ones? The idea of Box-Muller transform is the following: consider two independent random variables $$U_1, U_2 \sim \mathcal{U} (0, 1)$$. If you now calculate $$Z_1 = \sqrt{-2 \ln U_1} \cos(2 \pi U_2), Z_2 = \sqrt{-2 \ln U_1} \sin(2 \pi U_2)$$, then $$Z_1, Z_2 \sim \mathcal{N}(0, 1)$$ and they are also independent.

<video src="/assets/videos/sampling/BoxMuller.mp4" controls="controls" style="max-height:460px;">