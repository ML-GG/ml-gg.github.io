---
layout: post
title:  Sampling
date:   2022-04-17 18:26:10 +0200
description:    What does it mean to sample from a distribution?
categories: posts
---

## Premise

The operation of sampling is ubiquitous is statistics and machine learning. Many algorithms often require us to sample from normal distribution, or from a posterior distribution, or sometimes even sample from a function for which the formula is not fully known.  

In this short blog-post we will explain what sampling is about and give a few examples. However, we will assume one thing, namely that **we always can sample from uniform distribution between** $$0$$ **and** $$1$$. This is a fair assumption because of pseudorandom number generators such as mt19937 and many others that have been in use for decades for this exact purpose.  

We can now move to more interesting cases.


## Sampling from normal distribution - Box-Muller

First we will learn how to effectively sample from the normal distribution, arguably the most important of all distributions. You can do it in multiple ways, but here we will present a very efficient and clever procedure that is super easy to implement, it's called Box-Muller transform. The idea is simple, you take two samples from random uniform $$\mathcal{U} (0, 1)$$, you plug them into the Box-Muller transform and in return you get two samples from standard normal distribution $$\mathcal{N}(0, 1)$$.

So how exactly do you get normal samples from the uniform ones? The idea of Box-Muller transform is the following: consider two independent random uniform variables $$U_1, U_2 \sim \mathcal{U} (0, 1)$$. If you now calculate $$Z_1 = \sqrt{-2 \ln U_1} \cos(2 \pi U_2), Z_2 = \sqrt{-2 \ln U_1} \sin(2 \pi U_2)$$, then $$Z_1, Z_2 \sim \mathcal{N}(0, 1)$$ and they are also independent. 

We can of course turn these samples from standard normal distribution (mean $$0$$ and variance $$1$$ into any arbitrary normal distribution with mean $$\mu$$ and variance $$\sigma^2$$ simply by multiplying all samples by $$\sigma$$ and adding $$\mu$$. This is because $$ \sigma \cdot \mathcal{U} (0, 1) + \mu = \mathcal{U} (\mu, \sigma^2)$$.  


<video src="/assets/videos/sampling/BoxMuller.mp4" controls="controls" style="max-height:460px;"></video>

## Sampling from a distribution with known formula

Can we also turn samples from random uniform into samples from other distributions such as exponential, beta, gamma, etc.? It turns out we can. To explain how let us introduce cumulative distribution function (CDF).  

Every distribution has a probability density function (PDF), a non-negative function $$f$$ that integrates to $$1$$ and describes the distribution. A cumulative distribution function (CDF) is defined as the integral of PDF: $$F(x) = \int_{-\infty}^{x} f(x) \mathrm{d} x$$. CDF has a few useful features, namely:  
* \\(\lim_{x \to - \infty} F(x) = 0\\)
* \\(\lim_{x \to + \infty} F(x) = 1\\)
* \\(F\\) is non-decreasing  

todo

<div align="center">
  <video src="/assets/videos/sampling/UniformToNormal.mp4" controls="controls" style="max-height:460px;">
</div>